goog.provide('oc.web.components.stream_comments');
var module$node_modules$emoji_mart$dist$index=shadow.js.require("module$node_modules$emoji_mart$dist$index", {});
oc.web.components.stream_comments.stop_editing = (function oc$web$components$stream_comments$stop_editing(s,comment_data){
return cljs.core.reset_BANG_(new cljs.core.Keyword("oc.web.components.stream-comments","editing?","oc.web.components.stream-comments/editing?",443654745).cljs$core$IFn$_invoke$arity$1(s),null);
});
oc.web.components.stream_comments.cancel_edit = (function oc$web$components$stream_comments$cancel_edit(s,comment_data){
return oc.web.components.stream_comments.stop_editing(s,comment_data);
});
oc.web.components.stream_comments.finish_edit = (function oc$web$components$stream_comments$finish_edit(s,comment_data,cancel_QMARK_){
if(cljs.core.truth_(cancel_QMARK_)){
return oc.web.components.stream_comments.cancel_edit(s,comment_data);
} else {
return oc.web.components.stream_comments.stop_editing(s,comment_data);
}
});
oc.web.components.stream_comments.start_editing = (function oc$web$components$stream_comments$start_editing(s,comment_data){
var comment_node = rum.core.ref_node(s,["comment-body-",cljs.core.str.cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(comment_data))].join(''));
var activity_data = new cljs.core.Keyword(null,"activity-data","activity-data",1293689136).cljs$core$IFn$_invoke$arity$1(cljs.core.first(new cljs.core.Keyword("rum","args","rum/args",1315791754).cljs$core$IFn$_invoke$arity$1(s)));
oc.web.actions.comment.edit_comment(new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(activity_data),comment_data);

cljs.core.reset_BANG_(new cljs.core.Keyword("oc.web.components.stream-comments","show-more-menu","oc.web.components.stream-comments/show-more-menu",-866992705).cljs$core$IFn$_invoke$arity$1(s),null);

return cljs.core.reset_BANG_(new cljs.core.Keyword("oc.web.components.stream-comments","editing?","oc.web.components.stream-comments/editing?",443654745).cljs$core$IFn$_invoke$arity$1(s),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(comment_data));
});
oc.web.components.stream_comments.delete_clicked = (function oc$web$components$stream_comments$delete_clicked(e,activity_data,comment_data){
var alert_data = new cljs.core.PersistentArrayMap(null, 8, [new cljs.core.Keyword(null,"icon","icon",1679606541),"/img/ML/trash.svg",new cljs.core.Keyword(null,"action","action",-811238024),"delete-comment",new cljs.core.Keyword(null,"message","message",-406056002),((cljs.core.seq(new cljs.core.Keyword(null,"thread-children","thread-children",78675219).cljs$core$IFn$_invoke$arity$1(comment_data)))?"Delete this comment thread?":"Delete this comment?"),new cljs.core.Keyword(null,"link-button-title","link-button-title",-812305976),"No",new cljs.core.Keyword(null,"link-button-cb","link-button-cb",559710301),(function (){
return oc.web.components.ui.alert_modal.hide_alert();
}),new cljs.core.Keyword(null,"solid-button-style","solid-button-style",-723792244),new cljs.core.Keyword(null,"red","red",-969428204),new cljs.core.Keyword(null,"solid-button-title","solid-button-title",-970842567),"Yes",new cljs.core.Keyword(null,"solid-button-cb","solid-button-cb",-763410787),(function (_){
oc.web.actions.comment.delete_comment(activity_data,comment_data);

return oc.web.components.ui.alert_modal.hide_alert();
})], null);
return oc.web.components.ui.alert_modal.show_alert(alert_data);
});
oc.web.components.stream_comments.scroll_to_bottom = (function oc$web$components$stream_comments$scroll_to_bottom(s){
var scrolling_node = rum.core.dom_node(s);
return (scrolling_node.scrollTop = scrolling_node.scrollHeight);
});
oc.web.components.stream_comments.emoji_picked_cb = (function oc$web$components$stream_comments$emoji_picked_cb(s,comment_data,emoji){
return oc.web.actions.comment.react_from_picker(new cljs.core.Keyword(null,"activity-data","activity-data",1293689136).cljs$core$IFn$_invoke$arity$1(cljs.core.first(new cljs.core.Keyword("rum","args","rum/args",1315791754).cljs$core$IFn$_invoke$arity$1(s))),comment_data,cljs.core.get.cljs$core$IFn$_invoke$arity$2(emoji,"native"));
});
oc.web.components.stream_comments.add_comment_prefix = "edit-comment";
oc.web.components.stream_comments.copy_comment_url = (function oc$web$components$stream_comments$copy_comment_url(comment_url){
var input_field = document.createElement("input");
(input_field.style = "position:absolute;top:-999999px;left:-999999px;");

(input_field.value = comment_url);

document.body.appendChild(input_field);

input_field.select();

oc.web.lib.utils.copy_to_clipboard(input_field);

return document.body.removeChild(input_field);
});
oc.web.components.stream_comments.comment_mark_read = (function oc$web$components$stream_comments$comment_mark_read(s,comment_uuid){
var threads = cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","threads","oc.web.components.stream-comments/threads",468518835).cljs$core$IFn$_invoke$arity$1(s));
var idx = oc.web.lib.utils.index_of(threads,(function (p1__46070_SHARP_){
return cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(p1__46070_SHARP_),comment_uuid);
}));
return cljs.core.swap_BANG_.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword("oc.web.components.stream-comments","threads","oc.web.components.stream-comments/threads",468518835).cljs$core$IFn$_invoke$arity$1(s),(function (threads__$1){
return cljs.core.assoc_in(threads__$1,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [idx,new cljs.core.Keyword(null,"unread","unread",-1950424572)], null),false);
}));
});
oc.web.components.stream_comments.emoji_picker = rum.core.build_defc((function (p__46071){
var map__46072 = p__46071;
var map__46072__$1 = (((((!((map__46072 == null))))?(((((map__46072.cljs$lang$protocol_mask$partition0$ & (64))) || ((cljs.core.PROTOCOL_SENTINEL === map__46072.cljs$core$ISeq$))))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__46072):map__46072);
var add_emoji_cb = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46072__$1,new cljs.core.Keyword(null,"add-emoji-cb","add-emoji-cb",-375710574));
var dismiss_cb = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46072__$1,new cljs.core.Keyword(null,"dismiss-cb","dismiss-cb",-1282537857));
return React.createElement("div",({"className": "emoji-picker-container"}),React.createElement("button",({"onClick": dismiss_cb, "className": "mlb-reset close-bt"}),"Cancel"),sablono.interpreter.interpret(oc.web.lib.react_utils.build(module$node_modules$emoji_mart$dist$index.Picker,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"native","native",-613060878),true,new cljs.core.Keyword(null,"autoFocus","autoFocus",-552622425),true,new cljs.core.Keyword(null,"onClick","onClick",-1991238530),(function (emoji,_){
return (add_emoji_cb.cljs$core$IFn$_invoke$arity$1 ? add_emoji_cb.cljs$core$IFn$_invoke$arity$1(emoji) : add_emoji_cb.call(null,emoji));
})], null))));
}),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [(cljs.core.truth_(oc.web.lib.responsive.is_mobile_size_QMARK_())?oc.web.mixins.ui.no_scroll_mixin:null)], null),"emoji-picker");
oc.web.components.stream_comments.emoji_picker_container = (function oc$web$components$stream_comments$emoji_picker_container(s,comment_data){
var activity_data = new cljs.core.Keyword(null,"activity-data","activity-data",1293689136).cljs$core$IFn$_invoke$arity$1(cljs.core.first(new cljs.core.Keyword("rum","args","rum/args",1315791754).cljs$core$IFn$_invoke$arity$1(s)));
var showing_picker_QMARK_ = ((cljs.core.seq(cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","show-picker","oc.web.components.stream-comments/show-picker",-388195508).cljs$core$IFn$_invoke$arity$1(s)))) && (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","show-picker","oc.web.components.stream-comments/show-picker",-388195508).cljs$core$IFn$_invoke$arity$1(s)),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(comment_data))));
if(showing_picker_QMARK_){
var G__46076 = new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"dismiss-cb","dismiss-cb",-1282537857),(function (){
return cljs.core.reset_BANG_(new cljs.core.Keyword("oc.web.components.stream-comments","show-picker","oc.web.components.stream-comments/show-picker",-388195508).cljs$core$IFn$_invoke$arity$1(s),null);
}),new cljs.core.Keyword(null,"add-emoji-cb","add-emoji-cb",-375710574),(function (emoji){
if(oc.web.utils.reaction.can_pick_reaction_QMARK_(goog.object.get(emoji,"native"),new cljs.core.Keyword(null,"reactions","reactions",2029850654).cljs$core$IFn$_invoke$arity$1(comment_data))){
oc.web.components.stream_comments.comment_mark_read(s,new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(comment_data));

oc.web.actions.comment.react_from_picker(activity_data,comment_data,goog.object.get(emoji,"native"));
} else {
}

return cljs.core.reset_BANG_(new cljs.core.Keyword("oc.web.components.stream-comments","show-picker","oc.web.components.stream-comments/show-picker",-388195508).cljs$core$IFn$_invoke$arity$1(s),null);
})], null);
return (oc.web.components.stream_comments.emoji_picker.cljs$core$IFn$_invoke$arity$1 ? oc.web.components.stream_comments.emoji_picker.cljs$core$IFn$_invoke$arity$1(G__46076) : oc.web.components.stream_comments.emoji_picker.call(null,G__46076));
} else {
return null;
}
});
oc.web.components.stream_comments.edit_comment = rum.core.build_defc((function (p__46077){
var map__46078 = p__46077;
var map__46078__$1 = (((((!((map__46078 == null))))?(((((map__46078.cljs$lang$protocol_mask$partition0$ & (64))) || ((cljs.core.PROTOCOL_SENTINEL === map__46078.cljs$core$ISeq$))))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__46078):map__46078);
var activity_data = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46078__$1,new cljs.core.Keyword(null,"activity-data","activity-data",1293689136));
var comment_data = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46078__$1,new cljs.core.Keyword(null,"comment-data","comment-data",736267705));
var dismiss_reply_cb = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46078__$1,new cljs.core.Keyword(null,"dismiss-reply-cb","dismiss-reply-cb",1894601324));
var edit_comment_key = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46078__$1,new cljs.core.Keyword(null,"edit-comment-key","edit-comment-key",-1517723522));
var add_comment_cb = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46078__$1,new cljs.core.Keyword(null,"add-comment-cb","add-comment-cb",1940125120));
var add_comment_did_change = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46078__$1,new cljs.core.Keyword(null,"add-comment-did-change","add-comment-did-change",-325940488));
return React.createElement("div",({"key": ["stream-comment-",cljs.core.str.cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"created-at","created-at",-89248644).cljs$core$IFn$_invoke$arity$1(comment_data))].join(''), "data-comment-uuid": new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(comment_data), "className": "stream-comment-outer open-thread"}),(function (){var attrs46080 = rum.core.with_key((function (){var G__46081 = new cljs.core.PersistentArrayMap(null, 7, [new cljs.core.Keyword(null,"activity-data","activity-data",1293689136),activity_data,new cljs.core.Keyword(null,"parent-comment-uuid","parent-comment-uuid",-1757329834),new cljs.core.Keyword(null,"reply-parent","reply-parent",579138103).cljs$core$IFn$_invoke$arity$1(comment_data),new cljs.core.Keyword(null,"dismiss-reply-cb","dismiss-reply-cb",1894601324),dismiss_reply_cb,new cljs.core.Keyword(null,"add-comment-cb","add-comment-cb",1940125120),add_comment_cb,new cljs.core.Keyword(null,"add-comment-did-change","add-comment-did-change",-325940488),add_comment_did_change,new cljs.core.Keyword(null,"edit-comment-data","edit-comment-data",-1510189888),comment_data,new cljs.core.Keyword(null,"add-comment-focus-prefix","add-comment-focus-prefix",1635349699),oc.web.components.stream_comments.add_comment_prefix], null);
return (oc.web.components.ui.add_comment.add_comment.cljs$core$IFn$_invoke$arity$1 ? oc.web.components.ui.add_comment.add_comment.cljs$core$IFn$_invoke$arity$1(G__46081) : oc.web.components.ui.add_comment.add_comment.call(null,G__46081));
})(),["edit-comment-",cljs.core.str.cljs$core$IFn$_invoke$arity$1(edit_comment_key)].join(''));
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(React.createElement,"div",((cljs.core.map_QMARK_(attrs46080))?sablono.interpreter.attributes(sablono.normalize.merge_with_class.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",-2030961996),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment"], null)], null),attrs46080], 0))):({"className": "stream-comment"})),((cljs.core.map_QMARK_(attrs46080))?null:new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [sablono.interpreter.interpret(attrs46080)], null)));
})());
}),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [rum.core.static$], null),"edit-comment");
oc.web.components.stream_comments.read_comment = rum.core.build_defc((function (p__46082){
var map__46083 = p__46082;
var map__46083__$1 = (((((!((map__46083 == null))))?(((((map__46083.cljs$lang$protocol_mask$partition0$ & (64))) || ((cljs.core.PROTOCOL_SENTINEL === map__46083.cljs$core$ISeq$))))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__46083):map__46083);
var comment_data = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46083__$1,new cljs.core.Keyword(null,"comment-data","comment-data",736267705));
var delete_cb = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46083__$1,new cljs.core.Keyword(null,"delete-cb","delete-cb",895299386));
var emoji_picker = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46083__$1,new cljs.core.Keyword(null,"emoji-picker","emoji-picker",-447764229));
var show_more_menu = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46083__$1,new cljs.core.Keyword(null,"show-more-menu","show-more-menu",-283004228));
var edit_comment_key = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46083__$1,new cljs.core.Keyword(null,"edit-comment-key","edit-comment-key",-1517723522));
var editing_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46083__$1,new cljs.core.Keyword(null,"editing?","editing?",1646440800));
var did_react_cb = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46083__$1,new cljs.core.Keyword(null,"did-react-cb","did-react-cb",1627613154));
var is_mobile_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46083__$1,new cljs.core.Keyword(null,"is-mobile?","is-mobile?",2146205507));
var react_cb = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46083__$1,new cljs.core.Keyword(null,"react-cb","react-cb",-2110368957));
var edit_cb = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46083__$1,new cljs.core.Keyword(null,"edit-cb","edit-cb",-974954589));
var member_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46083__$1,new cljs.core.Keyword(null,"member?","member?",486668360));
var showing_picker_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46083__$1,new cljs.core.Keyword(null,"showing-picker?","showing-picker?",-369252247));
var can_show_delete_bt_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46083__$1,new cljs.core.Keyword(null,"can-show-delete-bt?","can-show-delete-bt?",-1502851606));
var reply_cb = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46083__$1,new cljs.core.Keyword(null,"reply-cb","reply-cb",-120094452));
var mouse_leave_cb = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46083__$1,new cljs.core.Keyword(null,"mouse-leave-cb","mouse-leave-cb",1257434096));
var activity_data = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46083__$1,new cljs.core.Keyword(null,"activity-data","activity-data",1293689136));
var can_show_edit_bt_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46083__$1,new cljs.core.Keyword(null,"can-show-edit-bt?","can-show-edit-bt?",-992517037));
var current_user_id = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46083__$1,new cljs.core.Keyword(null,"current-user-id","current-user-id",-2013633451));
return React.createElement("div",({"key": ["stream-comment-",cljs.core.str.cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"created-at","created-at",-89248644).cljs$core$IFn$_invoke$arity$1(comment_data))].join(''), "data-comment-uuid": new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(comment_data), "className": sablono.util.join_classes(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-outer","open-thread",oc.web.lib.utils.class_set(new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"new-comment","new-comment",1342914881),new cljs.core.Keyword(null,"unread","unread",-1950424572).cljs$core$IFn$_invoke$arity$1(comment_data),new cljs.core.Keyword(null,"showing-picker","showing-picker",-1081995369),showing_picker_QMARK_], null))], null))}),React.createElement("div",({"ref": ["stream-comment-",cljs.core.str.cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(comment_data))].join(''), "onMouseLeave": mouse_leave_cb, "className": sablono.util.join_classes(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment",oc.web.lib.utils.class_set(new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"editing-other-comment","editing-other-comment",1590145499),editing_QMARK_], null))], null))}),(function (){var attrs46085 = (cljs.core.truth_(is_mobile_QMARK_)?new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.stream-comment-mobile-menu","div.stream-comment-mobile-menu",-1193916073),(function (){var G__46086 = cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,"show-delete?","show-delete?",-753527136),new cljs.core.Keyword(null,"can-reply?","can-reply?",-61994911),new cljs.core.Keyword(null,"entity-type","entity-type",-1957300125),new cljs.core.Keyword(null,"show-edit?","show-edit?",-1476204765),new cljs.core.Keyword(null,"react-cb","react-cb",-2110368957),new cljs.core.Keyword(null,"edit-cb","edit-cb",-974954589),new cljs.core.Keyword(null,"can-react?","can-react?",680341130),new cljs.core.Keyword(null,"reply-cb","reply-cb",-120094452),new cljs.core.Keyword(null,"entity-data","entity-data",1608056141),new cljs.core.Keyword(null,"delete-cb","delete-cb",895299386)],[true,true,"comment",true,react_cb,edit_cb,true,reply_cb,comment_data,delete_cb]);
return (oc.web.components.ui.more_menu.more_menu.cljs$core$IFn$_invoke$arity$1 ? oc.web.components.ui.more_menu.more_menu.cljs$core$IFn$_invoke$arity$1(G__46086) : oc.web.components.ui.more_menu.more_menu.call(null,G__46086));
})(),emoji_picker], null):null);
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(React.createElement,"div",((cljs.core.map_QMARK_(attrs46085))?sablono.interpreter.attributes(sablono.normalize.merge_with_class.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",-2030961996),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-inner"], null)], null),attrs46085], 0))):({"className": "stream-comment-inner"})),((cljs.core.map_QMARK_(attrs46085))?new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [React.createElement("div",({"className": "stream-comment-right"}),React.createElement("div",({"className": sablono.util.join_classes(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-header","group",oc.web.lib.utils.hide_class], null))}),React.createElement("div",({"className": "stream-comment-author-right"}),React.createElement("div",({"className": sablono.util.join_classes(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-author-right-group",(cljs.core.truth_(new cljs.core.Keyword(null,"unread","unread",-1950424572).cljs$core$IFn$_invoke$arity$1(comment_data))?"new-comment":null)], null))}),(function (){var attrs46097 = (function (){var G__46102 = new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"user-data","user-data",2143823568),new cljs.core.Keyword(null,"author","author",2111686192).cljs$core$IFn$_invoke$arity$1(comment_data),new cljs.core.Keyword(null,"current-user-id","current-user-id",-2013633451),current_user_id,new cljs.core.Keyword(null,"leave-delay?","leave-delay?",654972741),true], null);
return (oc.web.components.ui.info_hover_views.user_info_hover.cljs$core$IFn$_invoke$arity$1 ? oc.web.components.ui.info_hover_views.user_info_hover.cljs$core$IFn$_invoke$arity$1(G__46102) : oc.web.components.ui.info_hover_views.user_info_hover.call(null,G__46102));
})();
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(React.createElement,"div",((cljs.core.map_QMARK_(attrs46097))?sablono.interpreter.attributes(sablono.normalize.merge_with_class.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",-2030961996),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-author-name-container"], null)], null),attrs46097], 0))):({"className": "stream-comment-author-name-container"})),((cljs.core.map_QMARK_(attrs46097))?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (){var attrs46098 = (function (){var G__46103 = new cljs.core.Keyword(null,"author","author",2111686192).cljs$core$IFn$_invoke$arity$1(comment_data);
return (oc.web.components.ui.user_avatar.user_avatar_image.cljs$core$IFn$_invoke$arity$1 ? oc.web.components.ui.user_avatar.user_avatar_image.cljs$core$IFn$_invoke$arity$1(G__46103) : oc.web.components.ui.user_avatar.user_avatar_image.call(null,G__46103));
})();
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(React.createElement,"div",((cljs.core.map_QMARK_(attrs46098))?sablono.interpreter.attributes(sablono.normalize.merge_with_class.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",-2030961996),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-author-avatar"], null)], null),attrs46098], 0))):({"className": "stream-comment-author-avatar"})),((cljs.core.map_QMARK_(attrs46098))?null:new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [sablono.interpreter.interpret(attrs46098)], null)));
})(),(function (){var attrs46099 = new cljs.core.Keyword(null,"name","name",1843675177).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"author","author",2111686192).cljs$core$IFn$_invoke$arity$1(comment_data));
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(React.createElement,"div",((cljs.core.map_QMARK_(attrs46099))?sablono.interpreter.attributes(sablono.normalize.merge_with_class.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",-2030961996),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-author-name"], null)], null),attrs46099], 0))):({"className": "stream-comment-author-name"})),((cljs.core.map_QMARK_(attrs46099))?null:new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [sablono.interpreter.interpret(attrs46099)], null)));
})()], null):new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [sablono.interpreter.interpret(attrs46097),(function (){var attrs46100 = (function (){var G__46110 = new cljs.core.Keyword(null,"author","author",2111686192).cljs$core$IFn$_invoke$arity$1(comment_data);
return (oc.web.components.ui.user_avatar.user_avatar_image.cljs$core$IFn$_invoke$arity$1 ? oc.web.components.ui.user_avatar.user_avatar_image.cljs$core$IFn$_invoke$arity$1(G__46110) : oc.web.components.ui.user_avatar.user_avatar_image.call(null,G__46110));
})();
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(React.createElement,"div",((cljs.core.map_QMARK_(attrs46100))?sablono.interpreter.attributes(sablono.normalize.merge_with_class.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",-2030961996),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-author-avatar"], null)], null),attrs46100], 0))):({"className": "stream-comment-author-avatar"})),((cljs.core.map_QMARK_(attrs46100))?null:new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [sablono.interpreter.interpret(attrs46100)], null)));
})(),(function (){var attrs46101 = new cljs.core.Keyword(null,"name","name",1843675177).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"author","author",2111686192).cljs$core$IFn$_invoke$arity$1(comment_data));
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(React.createElement,"div",((cljs.core.map_QMARK_(attrs46101))?sablono.interpreter.attributes(sablono.normalize.merge_with_class.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",-2030961996),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-author-name"], null)], null),attrs46101], 0))):({"className": "stream-comment-author-name"})),((cljs.core.map_QMARK_(attrs46101))?null:new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [sablono.interpreter.interpret(attrs46101)], null)));
})()], null)));
})(),React.createElement("div",({"className": "stream-comment-author-timestamp"}),React.createElement("time",({"dateTime": new cljs.core.Keyword(null,"created-at","created-at",-89248644).cljs$core$IFn$_invoke$arity$1(comment_data), "data-toggle": (cljs.core.truth_(is_mobile_QMARK_)?null:"tooltip"), "data-placement": "top", "data-container": "body", "data-delay": "{\"show\":\"1000\", \"hide\":\"0\"}", "data-title": oc.web.lib.utils.activity_date_tooltip(comment_data)}),sablono.interpreter.interpret(oc.web.lib.utils.foc_date_time(new cljs.core.Keyword(null,"created-at","created-at",-89248644).cljs$core$IFn$_invoke$arity$1(comment_data)))))),sablono.interpreter.interpret((cljs.core.truth_(new cljs.core.Keyword(null,"unread","unread",-1950424572).cljs$core$IFn$_invoke$arity$1(comment_data))?new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.new-comment-tag","div.new-comment-tag",2093863634)], null):null)),(cljs.core.truth_(oc.web.lib.responsive.is_mobile_size_QMARK_())?(function (){var attrs46120 = (function (){var G__46121 = comment_data;
var G__46122 = null;
var G__46123 = cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,"show-delete?","show-delete?",-753527136),new cljs.core.Keyword(null,"can-reply?","can-reply?",-61994911),new cljs.core.Keyword(null,"entity-type","entity-type",-1957300125),new cljs.core.Keyword(null,"show-edit?","show-edit?",-1476204765),new cljs.core.Keyword(null,"react-cb","react-cb",-2110368957),new cljs.core.Keyword(null,"edit-cb","edit-cb",-974954589),new cljs.core.Keyword(null,"can-react?","can-react?",680341130),new cljs.core.Keyword(null,"reply-cb","reply-cb",-120094452),new cljs.core.Keyword(null,"delete-cb","delete-cb",895299386)],[true,true,"comment",true,react_cb,edit_cb,true,reply_cb,delete_cb]);
return (oc.web.components.ui.more_menu.more_menu.cljs$core$IFn$_invoke$arity$3 ? oc.web.components.ui.more_menu.more_menu.cljs$core$IFn$_invoke$arity$3(G__46121,G__46122,G__46123) : oc.web.components.ui.more_menu.more_menu.call(null,G__46121,G__46122,G__46123));
})();
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(React.createElement,"div",((cljs.core.map_QMARK_(attrs46120))?sablono.interpreter.attributes(sablono.normalize.merge_with_class.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",-2030961996),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-mobile-menu"], null)], null),attrs46120], 0))):({"className": "stream-comment-mobile-menu"})),((cljs.core.map_QMARK_(attrs46120))?new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [sablono.interpreter.interpret(emoji_picker)], null):new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [sablono.interpreter.interpret(attrs46120),sablono.interpreter.interpret(emoji_picker)], null)));
})():React.createElement("div",({"key": ["stream-comment-floating-buttons",(cljs.core.truth_(can_show_edit_bt_QMARK_)?"-edit":null),(cljs.core.truth_(can_show_delete_bt_QMARK_)?"-delete":null)].join(''), "className": "stream-comment-floating-buttons"}),sablono.interpreter.interpret((cljs.core.truth_((function (){var or__4126__auto__ = can_show_delete_bt_QMARK_;
if(cljs.core.truth_(or__4126__auto__)){
return or__4126__auto__;
} else {
return can_show_edit_bt_QMARK_;
}
})())?new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.more-bt-container","div.more-bt-container",1959759254),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"button.mlb-reset.floating-bt.more-bt","button.mlb-reset.floating-bt.more-bt",1027167270),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"on-click","on-click",1632826543),(function (){
return cljs.core.reset_BANG_(show_more_menu,new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(comment_data));
})], null)], null),((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(show_more_menu),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(comment_data)))?new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.comment-more-menu-container","div.comment-more-menu-container",65564444),(cljs.core.truth_(can_show_delete_bt_QMARK_)?new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"button.mlb-reset.delete-bt","button.mlb-reset.delete-bt",-168688558),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"on-click","on-click",1632826543),(function (){
return (delete_cb.cljs$core$IFn$_invoke$arity$1 ? delete_cb.cljs$core$IFn$_invoke$arity$1(comment_data) : delete_cb.call(null,comment_data));
})], null),"Delete"], null):null),(cljs.core.truth_(can_show_edit_bt_QMARK_)?new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"button.mlb-reset.edit-bt","button.mlb-reset.edit-bt",1545149757),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"on-click","on-click",1632826543),(function (){
return (edit_cb.cljs$core$IFn$_invoke$arity$1 ? edit_cb.cljs$core$IFn$_invoke$arity$1(comment_data) : edit_cb.call(null,comment_data));
})], null),"Edit"], null):null)], null):null)], null):null)),sablono.interpreter.interpret((cljs.core.truth_(new cljs.core.Keyword(null,"reply-parent","reply-parent",579138103).cljs$core$IFn$_invoke$arity$1(comment_data))?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"button.mlb-reset.floating-bt.reply-bt","button.mlb-reset.floating-bt.reply-bt",-1373505302),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"data-toggle","data-toggle",436966687),"tooltip",new cljs.core.Keyword(null,"data-placement","data-placement",166529525),"top",new cljs.core.Keyword(null,"on-click","on-click",1632826543),reply_cb,new cljs.core.Keyword(null,"title","title",636505583),"Reply"], null)], null):null)),React.createElement("div",({"className": "react-bt-container"}),React.createElement("button",({"data-toggle": "tooltip", "data-placement": "top", "title": "Add reaction", "onClick": react_cb, "className": "mlb-reset floating-bt react-bt"})),sablono.interpreter.interpret(emoji_picker)))))),React.createElement("div",({"className": "stream-comment-content"}),React.createElement("div",({"dangerouslySetInnerHTML": oc.web.lib.utils.emojify(new cljs.core.Keyword(null,"body","body",-2049205669).cljs$core$IFn$_invoke$arity$1(comment_data)), "ref": ["comment-body-",cljs.core.str.cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(comment_data))].join(''), "className": sablono.util.join_classes(new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-body","oc-mentions","oc-mentions-hover",oc.web.lib.utils.class_set(cljs.core.PersistentArrayMap.createAsIfByAssoc([new cljs.core.Keyword(null,"emoji-comment","emoji-comment",1722031366),new cljs.core.Keyword(null,"is-emoji","is-emoji",-1643384064).cljs$core$IFn$_invoke$arity$1(comment_data),oc.web.lib.utils.hide_class,true]))], null))}))),sablono.interpreter.interpret(((cljs.core.seq(new cljs.core.Keyword(null,"reactions","reactions",2029850654).cljs$core$IFn$_invoke$arity$1(comment_data)))?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.stream-comment-reactions-footer.group","div.stream-comment-reactions-footer.group",-1585930682),(function (){var G__46135 = new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"entity-data","entity-data",1608056141),comment_data,new cljs.core.Keyword(null,"hide-picker","hide-picker",-1886003178),(cljs.core.count(new cljs.core.Keyword(null,"reactions","reactions",2029850654).cljs$core$IFn$_invoke$arity$1(comment_data)) === (0)),new cljs.core.Keyword(null,"did-react-cb","did-react-cb",1627613154),did_react_cb,new cljs.core.Keyword(null,"optional-activity-data","optional-activity-data",-1392718475),activity_data], null);
return (oc.web.components.reactions.reactions.cljs$core$IFn$_invoke$arity$1 ? oc.web.components.reactions.reactions.cljs$core$IFn$_invoke$arity$1(G__46135) : oc.web.components.reactions.reactions.call(null,G__46135));
})()], null):null)))], null):new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [sablono.interpreter.interpret(attrs46085),React.createElement("div",({"className": "stream-comment-right"}),React.createElement("div",({"className": sablono.util.join_classes(new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-header","group",oc.web.lib.utils.hide_class], null))}),React.createElement("div",({"className": "stream-comment-author-right"}),React.createElement("div",({"className": sablono.util.join_classes(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-author-right-group",(cljs.core.truth_(new cljs.core.Keyword(null,"unread","unread",-1950424572).cljs$core$IFn$_invoke$arity$1(comment_data))?"new-comment":null)], null))}),(function (){var attrs46140 = (function (){var G__46145 = new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"user-data","user-data",2143823568),new cljs.core.Keyword(null,"author","author",2111686192).cljs$core$IFn$_invoke$arity$1(comment_data),new cljs.core.Keyword(null,"current-user-id","current-user-id",-2013633451),current_user_id,new cljs.core.Keyword(null,"leave-delay?","leave-delay?",654972741),true], null);
return (oc.web.components.ui.info_hover_views.user_info_hover.cljs$core$IFn$_invoke$arity$1 ? oc.web.components.ui.info_hover_views.user_info_hover.cljs$core$IFn$_invoke$arity$1(G__46145) : oc.web.components.ui.info_hover_views.user_info_hover.call(null,G__46145));
})();
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(React.createElement,"div",((cljs.core.map_QMARK_(attrs46140))?sablono.interpreter.attributes(sablono.normalize.merge_with_class.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",-2030961996),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-author-name-container"], null)], null),attrs46140], 0))):({"className": "stream-comment-author-name-container"})),((cljs.core.map_QMARK_(attrs46140))?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(function (){var attrs46141 = (function (){var G__46146 = new cljs.core.Keyword(null,"author","author",2111686192).cljs$core$IFn$_invoke$arity$1(comment_data);
return (oc.web.components.ui.user_avatar.user_avatar_image.cljs$core$IFn$_invoke$arity$1 ? oc.web.components.ui.user_avatar.user_avatar_image.cljs$core$IFn$_invoke$arity$1(G__46146) : oc.web.components.ui.user_avatar.user_avatar_image.call(null,G__46146));
})();
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(React.createElement,"div",((cljs.core.map_QMARK_(attrs46141))?sablono.interpreter.attributes(sablono.normalize.merge_with_class.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",-2030961996),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-author-avatar"], null)], null),attrs46141], 0))):({"className": "stream-comment-author-avatar"})),((cljs.core.map_QMARK_(attrs46141))?null:new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [sablono.interpreter.interpret(attrs46141)], null)));
})(),(function (){var attrs46142 = new cljs.core.Keyword(null,"name","name",1843675177).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"author","author",2111686192).cljs$core$IFn$_invoke$arity$1(comment_data));
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(React.createElement,"div",((cljs.core.map_QMARK_(attrs46142))?sablono.interpreter.attributes(sablono.normalize.merge_with_class.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",-2030961996),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-author-name"], null)], null),attrs46142], 0))):({"className": "stream-comment-author-name"})),((cljs.core.map_QMARK_(attrs46142))?null:new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [sablono.interpreter.interpret(attrs46142)], null)));
})()], null):new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [sablono.interpreter.interpret(attrs46140),(function (){var attrs46143 = (function (){var G__46147 = new cljs.core.Keyword(null,"author","author",2111686192).cljs$core$IFn$_invoke$arity$1(comment_data);
return (oc.web.components.ui.user_avatar.user_avatar_image.cljs$core$IFn$_invoke$arity$1 ? oc.web.components.ui.user_avatar.user_avatar_image.cljs$core$IFn$_invoke$arity$1(G__46147) : oc.web.components.ui.user_avatar.user_avatar_image.call(null,G__46147));
})();
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(React.createElement,"div",((cljs.core.map_QMARK_(attrs46143))?sablono.interpreter.attributes(sablono.normalize.merge_with_class.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",-2030961996),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-author-avatar"], null)], null),attrs46143], 0))):({"className": "stream-comment-author-avatar"})),((cljs.core.map_QMARK_(attrs46143))?null:new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [sablono.interpreter.interpret(attrs46143)], null)));
})(),(function (){var attrs46144 = new cljs.core.Keyword(null,"name","name",1843675177).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"author","author",2111686192).cljs$core$IFn$_invoke$arity$1(comment_data));
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(React.createElement,"div",((cljs.core.map_QMARK_(attrs46144))?sablono.interpreter.attributes(sablono.normalize.merge_with_class.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",-2030961996),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-author-name"], null)], null),attrs46144], 0))):({"className": "stream-comment-author-name"})),((cljs.core.map_QMARK_(attrs46144))?null:new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [sablono.interpreter.interpret(attrs46144)], null)));
})()], null)));
})(),React.createElement("div",({"className": "stream-comment-author-timestamp"}),React.createElement("time",({"dateTime": new cljs.core.Keyword(null,"created-at","created-at",-89248644).cljs$core$IFn$_invoke$arity$1(comment_data), "data-toggle": (cljs.core.truth_(is_mobile_QMARK_)?null:"tooltip"), "data-placement": "top", "data-container": "body", "data-delay": "{\"show\":\"1000\", \"hide\":\"0\"}", "data-title": oc.web.lib.utils.activity_date_tooltip(comment_data)}),sablono.interpreter.interpret(oc.web.lib.utils.foc_date_time(new cljs.core.Keyword(null,"created-at","created-at",-89248644).cljs$core$IFn$_invoke$arity$1(comment_data)))))),sablono.interpreter.interpret((cljs.core.truth_(new cljs.core.Keyword(null,"unread","unread",-1950424572).cljs$core$IFn$_invoke$arity$1(comment_data))?new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.new-comment-tag","div.new-comment-tag",2093863634)], null):null)),(cljs.core.truth_(oc.web.lib.responsive.is_mobile_size_QMARK_())?(function (){var attrs46148 = (function (){var G__46149 = comment_data;
var G__46150 = null;
var G__46151 = cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,"show-delete?","show-delete?",-753527136),new cljs.core.Keyword(null,"can-reply?","can-reply?",-61994911),new cljs.core.Keyword(null,"entity-type","entity-type",-1957300125),new cljs.core.Keyword(null,"show-edit?","show-edit?",-1476204765),new cljs.core.Keyword(null,"react-cb","react-cb",-2110368957),new cljs.core.Keyword(null,"edit-cb","edit-cb",-974954589),new cljs.core.Keyword(null,"can-react?","can-react?",680341130),new cljs.core.Keyword(null,"reply-cb","reply-cb",-120094452),new cljs.core.Keyword(null,"delete-cb","delete-cb",895299386)],[true,true,"comment",true,react_cb,edit_cb,true,reply_cb,delete_cb]);
return (oc.web.components.ui.more_menu.more_menu.cljs$core$IFn$_invoke$arity$3 ? oc.web.components.ui.more_menu.more_menu.cljs$core$IFn$_invoke$arity$3(G__46149,G__46150,G__46151) : oc.web.components.ui.more_menu.more_menu.call(null,G__46149,G__46150,G__46151));
})();
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(React.createElement,"div",((cljs.core.map_QMARK_(attrs46148))?sablono.interpreter.attributes(sablono.normalize.merge_with_class.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",-2030961996),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-mobile-menu"], null)], null),attrs46148], 0))):({"className": "stream-comment-mobile-menu"})),((cljs.core.map_QMARK_(attrs46148))?new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [sablono.interpreter.interpret(emoji_picker)], null):new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [sablono.interpreter.interpret(attrs46148),sablono.interpreter.interpret(emoji_picker)], null)));
})():React.createElement("div",({"key": ["stream-comment-floating-buttons",(cljs.core.truth_(can_show_edit_bt_QMARK_)?"-edit":null),(cljs.core.truth_(can_show_delete_bt_QMARK_)?"-delete":null)].join(''), "className": "stream-comment-floating-buttons"}),sablono.interpreter.interpret((cljs.core.truth_((function (){var or__4126__auto__ = can_show_delete_bt_QMARK_;
if(cljs.core.truth_(or__4126__auto__)){
return or__4126__auto__;
} else {
return can_show_edit_bt_QMARK_;
}
})())?new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.more-bt-container","div.more-bt-container",1959759254),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"button.mlb-reset.floating-bt.more-bt","button.mlb-reset.floating-bt.more-bt",1027167270),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"on-click","on-click",1632826543),(function (){
return cljs.core.reset_BANG_(show_more_menu,new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(comment_data));
})], null)], null),((cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(show_more_menu),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(comment_data)))?new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.comment-more-menu-container","div.comment-more-menu-container",65564444),(cljs.core.truth_(can_show_delete_bt_QMARK_)?new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"button.mlb-reset.delete-bt","button.mlb-reset.delete-bt",-168688558),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"on-click","on-click",1632826543),(function (){
return (delete_cb.cljs$core$IFn$_invoke$arity$1 ? delete_cb.cljs$core$IFn$_invoke$arity$1(comment_data) : delete_cb.call(null,comment_data));
})], null),"Delete"], null):null),(cljs.core.truth_(can_show_edit_bt_QMARK_)?new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"button.mlb-reset.edit-bt","button.mlb-reset.edit-bt",1545149757),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"on-click","on-click",1632826543),(function (){
return (edit_cb.cljs$core$IFn$_invoke$arity$1 ? edit_cb.cljs$core$IFn$_invoke$arity$1(comment_data) : edit_cb.call(null,comment_data));
})], null),"Edit"], null):null)], null):null)], null):null)),sablono.interpreter.interpret((cljs.core.truth_(new cljs.core.Keyword(null,"reply-parent","reply-parent",579138103).cljs$core$IFn$_invoke$arity$1(comment_data))?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"button.mlb-reset.floating-bt.reply-bt","button.mlb-reset.floating-bt.reply-bt",-1373505302),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"data-toggle","data-toggle",436966687),"tooltip",new cljs.core.Keyword(null,"data-placement","data-placement",166529525),"top",new cljs.core.Keyword(null,"on-click","on-click",1632826543),reply_cb,new cljs.core.Keyword(null,"title","title",636505583),"Reply"], null)], null):null)),React.createElement("div",({"className": "react-bt-container"}),React.createElement("button",({"data-toggle": "tooltip", "data-placement": "top", "title": "Add reaction", "onClick": react_cb, "className": "mlb-reset floating-bt react-bt"})),sablono.interpreter.interpret(emoji_picker)))))),React.createElement("div",({"className": "stream-comment-content"}),React.createElement("div",({"dangerouslySetInnerHTML": oc.web.lib.utils.emojify(new cljs.core.Keyword(null,"body","body",-2049205669).cljs$core$IFn$_invoke$arity$1(comment_data)), "ref": ["comment-body-",cljs.core.str.cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(comment_data))].join(''), "className": sablono.util.join_classes(new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comment-body","oc-mentions","oc-mentions-hover",oc.web.lib.utils.class_set(cljs.core.PersistentArrayMap.createAsIfByAssoc([new cljs.core.Keyword(null,"emoji-comment","emoji-comment",1722031366),new cljs.core.Keyword(null,"is-emoji","is-emoji",-1643384064).cljs$core$IFn$_invoke$arity$1(comment_data),oc.web.lib.utils.hide_class,true]))], null))}))),sablono.interpreter.interpret(((cljs.core.seq(new cljs.core.Keyword(null,"reactions","reactions",2029850654).cljs$core$IFn$_invoke$arity$1(comment_data)))?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.stream-comment-reactions-footer.group","div.stream-comment-reactions-footer.group",-1585930682),(function (){var G__46153 = new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"entity-data","entity-data",1608056141),comment_data,new cljs.core.Keyword(null,"hide-picker","hide-picker",-1886003178),(cljs.core.count(new cljs.core.Keyword(null,"reactions","reactions",2029850654).cljs$core$IFn$_invoke$arity$1(comment_data)) === (0)),new cljs.core.Keyword(null,"did-react-cb","did-react-cb",1627613154),did_react_cb,new cljs.core.Keyword(null,"optional-activity-data","optional-activity-data",-1392718475),activity_data], null);
return (oc.web.components.reactions.reactions.cljs$core$IFn$_invoke$arity$1 ? oc.web.components.reactions.reactions.cljs$core$IFn$_invoke$arity$1(G__46153) : oc.web.components.reactions.reactions.call(null,G__46153));
})()], null):null)))], null)));
})()));
}),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [rum.core.static$], null),"read-comment");
oc.web.components.stream_comments.stream_comments = rum.core.build_defcs((function (s,p__46162){
var map__46163 = p__46162;
var map__46163__$1 = (((((!((map__46163 == null))))?(((((map__46163.cljs$lang$protocol_mask$partition0$ & (64))) || ((cljs.core.PROTOCOL_SENTINEL === map__46163.cljs$core$ISeq$))))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__46163):map__46163);
var activity_data = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46163__$1,new cljs.core.Keyword(null,"activity-data","activity-data",1293689136));
var comments_data = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46163__$1,new cljs.core.Keyword(null,"comments-data","comments-data",1871210833));
var last_read_at = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46163__$1,new cljs.core.Keyword(null,"last-read-at","last-read-at",-216601930));
var current_user_id = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46163__$1,new cljs.core.Keyword(null,"current-user-id","current-user-id",-2013633451));
var member_QMARK_ = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46163__$1,new cljs.core.Keyword(null,"member?","member?",486668360));
var reply_add_comment_prefix = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46163__$1,new cljs.core.Keyword(null,"reply-add-comment-prefix","reply-add-comment-prefix",1123094795));
var loading_comments_count = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46163__$1,new cljs.core.Keyword(null,"loading-comments-count","loading-comments-count",190347930));
var _users_info_hover = org.martinklepsch.derivatives.react(s,new cljs.core.Keyword(null,"users-info-hover","users-info-hover",-941434570));
var _current_user_data = org.martinklepsch.derivatives.react(s,new cljs.core.Keyword(null,"current-user-data","current-user-data",-1647873915));
var _follow_publishers_list = org.martinklepsch.derivatives.react(s,new cljs.core.Keyword(null,"follow-publishers-list","follow-publishers-list",-374150342));
var _followers_publishers_count = org.martinklepsch.derivatives.react(s,new cljs.core.Keyword(null,"followers-publishers-count","followers-publishers-count",-692976579));
var add_comment_force_update_STAR_ = org.martinklepsch.derivatives.react(s,new cljs.core.Keyword(null,"add-comment-force-update","add-comment-force-update",1376707794));
var is_mobile_QMARK_ = oc.web.lib.responsive.is_mobile_size_QMARK_();
var threads = cljs.core.filter.cljs$core$IFn$_invoke$arity$2(oc.web.utils.activity.comment_QMARK_,cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","threads","oc.web.components.stream-comments/threads",468518835).cljs$core$IFn$_invoke$arity$1(s)));
var all_comments = cljs.core.vec(cljs.core.mapcat.cljs$core$IFn$_invoke$arity$variadic((function (p1__46158_SHARP_){
return cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [p1__46158_SHARP_], null),new cljs.core.Keyword(null,"thread-children","thread-children",78675219).cljs$core$IFn$_invoke$arity$1(p1__46158_SHARP_));
}),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([threads], 0)));
var reply_focus_value = oc.web.utils.comment.add_comment_focus_value.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([reply_add_comment_prefix,new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(activity_data)], 0));
return React.createElement("div",({"className": sablono.util.join_classes(new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comments",((cljs.core.seq(cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","editing?","oc.web.components.stream-comments/editing?",443654745).cljs$core$IFn$_invoke$arity$1(s))))?"editing":null)], null))}),(((cljs.core.count(threads) > (0)))?(function (){var attrs46172 = (((loading_comments_count > (0)))?new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.stream-comments-list-loading","div.stream-comments-list-loading",-577511484),(oc.web.components.ui.small_loading.small_loading.cljs$core$IFn$_invoke$arity$0 ? oc.web.components.ui.small_loading.small_loading.cljs$core$IFn$_invoke$arity$0() : oc.web.components.ui.small_loading.small_loading.call(null)),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"span.span.stream-comments-loading-inner","span.span.stream-comments-loading-inner",-1563585470),"Loading ",loading_comments_count," more comments..."], null)], null):null);
return cljs.core.apply.cljs$core$IFn$_invoke$arity$4(React.createElement,"div",((cljs.core.map_QMARK_(attrs46172))?sablono.interpreter.attributes(sablono.normalize.merge_with_class.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"class","class",-2030961996),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, ["stream-comments-list"], null)], null),attrs46172], 0))):({"className": "stream-comments-list"})),((cljs.core.map_QMARK_(attrs46172))?new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [cljs.core.into_array.cljs$core$IFn$_invoke$arity$1((function (){var iter__4529__auto__ = (function oc$web$components$stream_comments$iter__46177(s__46178){
return (new cljs.core.LazySeq(null,(function (){
var s__46178__$1 = s__46178;
while(true){
var temp__5735__auto__ = cljs.core.seq(s__46178__$1);
if(temp__5735__auto__){
var s__46178__$2 = temp__5735__auto__;
if(cljs.core.chunked_seq_QMARK_(s__46178__$2)){
var c__4527__auto__ = cljs.core.chunk_first(s__46178__$2);
var size__4528__auto__ = cljs.core.count(c__4527__auto__);
var b__46180 = cljs.core.chunk_buffer(size__4528__auto__);
if((function (){var i__46179 = (0);
while(true){
if((i__46179 < size__4528__auto__)){
var idx = cljs.core._nth(c__4527__auto__,i__46179);
var root_comment_data = cljs.core.nth.cljs$core$IFn$_invoke$arity$2(threads,idx);
var is_editing_QMARK_ = ((cljs.core.seq(cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","editing?","oc.web.components.stream-comments/editing?",443654745).cljs$core$IFn$_invoke$arity$1(s)))) && (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","editing?","oc.web.components.stream-comments/editing?",443654745).cljs$core$IFn$_invoke$arity$1(s)),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data))));
var add_comment_string_key = oc.web.dispatcher.add_comment_string_key.cljs$core$IFn$_invoke$arity$3(new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(activity_data),new cljs.core.Keyword(null,"reply-parent","reply-parent",579138103).cljs$core$IFn$_invoke$arity$1(root_comment_data),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data));
var edit_comment_key = cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(add_comment_force_update_STAR_,add_comment_string_key);
var showing_picker_QMARK_ = ((cljs.core.seq(cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","show-picker","oc.web.components.stream-comments/show-picker",-388195508).cljs$core$IFn$_invoke$arity$1(s)))) && (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","show-picker","oc.web.components.stream-comments/show-picker",-388195508).cljs$core$IFn$_invoke$arity$1(s)),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data))));
cljs.core.chunk_append(b__46180,React.createElement("div",({"key": ["stream-comments-thread-",cljs.core.str.cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data))].join(''), "className": "stream-comment-thread"}),((is_editing_QMARK_)?sablono.interpreter.interpret((function (){var G__46186 = new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"activity-data","activity-data",1293689136),activity_data,new cljs.core.Keyword(null,"comment-data","comment-data",736267705),root_comment_data,new cljs.core.Keyword(null,"dismiss-reply-cb","dismiss-reply-cb",1894601324),cljs.core.partial.cljs$core$IFn$_invoke$arity$3(oc.web.components.stream_comments.finish_edit,s,root_comment_data),new cljs.core.Keyword(null,"edit-comment-key","edit-comment-key",-1517723522),edit_comment_key], null);
return (oc.web.components.stream_comments.edit_comment.cljs$core$IFn$_invoke$arity$1 ? oc.web.components.stream_comments.edit_comment.cljs$core$IFn$_invoke$arity$1(G__46186) : oc.web.components.stream_comments.edit_comment.call(null,G__46186));
})()):sablono.interpreter.interpret((function (){var G__46187 = cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,"editing?","editing?",1646440800),new cljs.core.Keyword(null,"did-react-cb","did-react-cb",1627613154),new cljs.core.Keyword(null,"react-cb","react-cb",-2110368957),new cljs.core.Keyword(null,"is-mobile?","is-mobile?",2146205507),new cljs.core.Keyword(null,"edit-cb","edit-cb",-974954589),new cljs.core.Keyword(null,"member?","member?",486668360),new cljs.core.Keyword(null,"showing-picker?","showing-picker?",-369252247),new cljs.core.Keyword(null,"can-show-delete-bt?","can-show-delete-bt?",-1502851606),new cljs.core.Keyword(null,"reply-cb","reply-cb",-120094452),new cljs.core.Keyword(null,"dismiss-reply-cb","dismiss-reply-cb",1894601324),new cljs.core.Keyword(null,"activity-data","activity-data",1293689136),new cljs.core.Keyword(null,"mouse-leave-cb","mouse-leave-cb",1257434096),new cljs.core.Keyword(null,"can-show-edit-bt?","can-show-edit-bt?",-992517037),new cljs.core.Keyword(null,"current-user-id","current-user-id",-2013633451),new cljs.core.Keyword(null,"comment-data","comment-data",736267705),new cljs.core.Keyword(null,"delete-cb","delete-cb",895299386),new cljs.core.Keyword(null,"emoji-picker","emoji-picker",-447764229),new cljs.core.Keyword(null,"show-more-menu","show-more-menu",-283004228),new cljs.core.Keyword(null,"edit-comment-key","edit-comment-key",-1517723522)],[(!((cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","editing?","oc.web.components.stream-comments/editing?",443654745).cljs$core$IFn$_invoke$arity$1(s)) == null))),((function (i__46179,root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,c__4527__auto__,size__4528__auto__,b__46180,s__46178__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count){
return (function (){
return oc.web.components.stream_comments.comment_mark_read(s,new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data));
});})(i__46179,root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,c__4527__auto__,size__4528__auto__,b__46180,s__46178__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count))
,((function (i__46179,root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,c__4527__auto__,size__4528__auto__,b__46180,s__46178__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count){
return (function (){
return cljs.core.reset_BANG_(new cljs.core.Keyword("oc.web.components.stream-comments","show-picker","oc.web.components.stream-comments/show-picker",-388195508).cljs$core$IFn$_invoke$arity$1(s),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data));
});})(i__46179,root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,c__4527__auto__,size__4528__auto__,b__46180,s__46178__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count))
,is_mobile_QMARK_,cljs.core.partial.cljs$core$IFn$_invoke$arity$2(oc.web.components.stream_comments.start_editing,s),member_QMARK_,showing_picker_QMARK_,new cljs.core.Keyword(null,"can-delete","can-delete",1620748590).cljs$core$IFn$_invoke$arity$1(root_comment_data),((function (i__46179,root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,c__4527__auto__,size__4528__auto__,b__46180,s__46178__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count){
return (function (){
return oc.web.actions.comment.reply_to.cljs$core$IFn$_invoke$arity$variadic(reply_focus_value,new cljs.core.Keyword(null,"body","body",-2049205669).cljs$core$IFn$_invoke$arity$1(root_comment_data),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([true], 0));
});})(i__46179,root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,c__4527__auto__,size__4528__auto__,b__46180,s__46178__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count))
,cljs.core.partial.cljs$core$IFn$_invoke$arity$3(oc.web.components.stream_comments.finish_edit,s,root_comment_data),activity_data,((function (i__46179,root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,c__4527__auto__,size__4528__auto__,b__46180,s__46178__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count){
return (function (){
return cljs.core.compare_and_set_BANG_(new cljs.core.Keyword("oc.web.components.stream-comments","show-more-menu","oc.web.components.stream-comments/show-more-menu",-866992705).cljs$core$IFn$_invoke$arity$1(s),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data),null);
});})(i__46179,root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,c__4527__auto__,size__4528__auto__,b__46180,s__46178__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count))
,(function (){var and__4115__auto__ = new cljs.core.Keyword(null,"can-edit","can-edit",442089902).cljs$core$IFn$_invoke$arity$1(root_comment_data);
if(cljs.core.truth_(and__4115__auto__)){
return cljs.core.not(new cljs.core.Keyword(null,"is-emoji","is-emoji",-1643384064).cljs$core$IFn$_invoke$arity$1(root_comment_data));
} else {
return and__4115__auto__;
}
})(),current_user_id,root_comment_data,cljs.core.partial.cljs$core$IFn$_invoke$arity$3(oc.web.components.stream_comments.delete_clicked,s,activity_data),((showing_picker_QMARK_)?oc.web.components.stream_comments.emoji_picker_container(s,root_comment_data):null),new cljs.core.Keyword("oc.web.components.stream-comments","show-more-menu","oc.web.components.stream-comments/show-more-menu",-866992705).cljs$core$IFn$_invoke$arity$1(s),edit_comment_key]);
return (oc.web.components.stream_comments.read_comment.cljs$core$IFn$_invoke$arity$1 ? oc.web.components.stream_comments.read_comment.cljs$core$IFn$_invoke$arity$1(G__46187) : oc.web.components.stream_comments.read_comment.call(null,G__46187));
})()))));

var G__46276 = (i__46179 + (1));
i__46179 = G__46276;
continue;
} else {
return true;
}
break;
}
})()){
return cljs.core.chunk_cons(cljs.core.chunk(b__46180),oc$web$components$stream_comments$iter__46177(cljs.core.chunk_rest(s__46178__$2)));
} else {
return cljs.core.chunk_cons(cljs.core.chunk(b__46180),null);
}
} else {
var idx = cljs.core.first(s__46178__$2);
var root_comment_data = cljs.core.nth.cljs$core$IFn$_invoke$arity$2(threads,idx);
var is_editing_QMARK_ = ((cljs.core.seq(cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","editing?","oc.web.components.stream-comments/editing?",443654745).cljs$core$IFn$_invoke$arity$1(s)))) && (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","editing?","oc.web.components.stream-comments/editing?",443654745).cljs$core$IFn$_invoke$arity$1(s)),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data))));
var add_comment_string_key = oc.web.dispatcher.add_comment_string_key.cljs$core$IFn$_invoke$arity$3(new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(activity_data),new cljs.core.Keyword(null,"reply-parent","reply-parent",579138103).cljs$core$IFn$_invoke$arity$1(root_comment_data),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data));
var edit_comment_key = cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(add_comment_force_update_STAR_,add_comment_string_key);
var showing_picker_QMARK_ = ((cljs.core.seq(cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","show-picker","oc.web.components.stream-comments/show-picker",-388195508).cljs$core$IFn$_invoke$arity$1(s)))) && (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","show-picker","oc.web.components.stream-comments/show-picker",-388195508).cljs$core$IFn$_invoke$arity$1(s)),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data))));
return cljs.core.cons(React.createElement("div",({"key": ["stream-comments-thread-",cljs.core.str.cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data))].join(''), "className": "stream-comment-thread"}),((is_editing_QMARK_)?sablono.interpreter.interpret((function (){var G__46189 = new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"activity-data","activity-data",1293689136),activity_data,new cljs.core.Keyword(null,"comment-data","comment-data",736267705),root_comment_data,new cljs.core.Keyword(null,"dismiss-reply-cb","dismiss-reply-cb",1894601324),cljs.core.partial.cljs$core$IFn$_invoke$arity$3(oc.web.components.stream_comments.finish_edit,s,root_comment_data),new cljs.core.Keyword(null,"edit-comment-key","edit-comment-key",-1517723522),edit_comment_key], null);
return (oc.web.components.stream_comments.edit_comment.cljs$core$IFn$_invoke$arity$1 ? oc.web.components.stream_comments.edit_comment.cljs$core$IFn$_invoke$arity$1(G__46189) : oc.web.components.stream_comments.edit_comment.call(null,G__46189));
})()):sablono.interpreter.interpret((function (){var G__46190 = cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,"editing?","editing?",1646440800),new cljs.core.Keyword(null,"did-react-cb","did-react-cb",1627613154),new cljs.core.Keyword(null,"react-cb","react-cb",-2110368957),new cljs.core.Keyword(null,"is-mobile?","is-mobile?",2146205507),new cljs.core.Keyword(null,"edit-cb","edit-cb",-974954589),new cljs.core.Keyword(null,"member?","member?",486668360),new cljs.core.Keyword(null,"showing-picker?","showing-picker?",-369252247),new cljs.core.Keyword(null,"can-show-delete-bt?","can-show-delete-bt?",-1502851606),new cljs.core.Keyword(null,"reply-cb","reply-cb",-120094452),new cljs.core.Keyword(null,"dismiss-reply-cb","dismiss-reply-cb",1894601324),new cljs.core.Keyword(null,"activity-data","activity-data",1293689136),new cljs.core.Keyword(null,"mouse-leave-cb","mouse-leave-cb",1257434096),new cljs.core.Keyword(null,"can-show-edit-bt?","can-show-edit-bt?",-992517037),new cljs.core.Keyword(null,"current-user-id","current-user-id",-2013633451),new cljs.core.Keyword(null,"comment-data","comment-data",736267705),new cljs.core.Keyword(null,"delete-cb","delete-cb",895299386),new cljs.core.Keyword(null,"emoji-picker","emoji-picker",-447764229),new cljs.core.Keyword(null,"show-more-menu","show-more-menu",-283004228),new cljs.core.Keyword(null,"edit-comment-key","edit-comment-key",-1517723522)],[(!((cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","editing?","oc.web.components.stream-comments/editing?",443654745).cljs$core$IFn$_invoke$arity$1(s)) == null))),((function (root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,s__46178__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count){
return (function (){
return oc.web.components.stream_comments.comment_mark_read(s,new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data));
});})(root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,s__46178__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count))
,((function (root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,s__46178__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count){
return (function (){
return cljs.core.reset_BANG_(new cljs.core.Keyword("oc.web.components.stream-comments","show-picker","oc.web.components.stream-comments/show-picker",-388195508).cljs$core$IFn$_invoke$arity$1(s),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data));
});})(root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,s__46178__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count))
,is_mobile_QMARK_,cljs.core.partial.cljs$core$IFn$_invoke$arity$2(oc.web.components.stream_comments.start_editing,s),member_QMARK_,showing_picker_QMARK_,new cljs.core.Keyword(null,"can-delete","can-delete",1620748590).cljs$core$IFn$_invoke$arity$1(root_comment_data),((function (root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,s__46178__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count){
return (function (){
return oc.web.actions.comment.reply_to.cljs$core$IFn$_invoke$arity$variadic(reply_focus_value,new cljs.core.Keyword(null,"body","body",-2049205669).cljs$core$IFn$_invoke$arity$1(root_comment_data),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([true], 0));
});})(root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,s__46178__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count))
,cljs.core.partial.cljs$core$IFn$_invoke$arity$3(oc.web.components.stream_comments.finish_edit,s,root_comment_data),activity_data,((function (root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,s__46178__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count){
return (function (){
return cljs.core.compare_and_set_BANG_(new cljs.core.Keyword("oc.web.components.stream-comments","show-more-menu","oc.web.components.stream-comments/show-more-menu",-866992705).cljs$core$IFn$_invoke$arity$1(s),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data),null);
});})(root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,s__46178__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count))
,(function (){var and__4115__auto__ = new cljs.core.Keyword(null,"can-edit","can-edit",442089902).cljs$core$IFn$_invoke$arity$1(root_comment_data);
if(cljs.core.truth_(and__4115__auto__)){
return cljs.core.not(new cljs.core.Keyword(null,"is-emoji","is-emoji",-1643384064).cljs$core$IFn$_invoke$arity$1(root_comment_data));
} else {
return and__4115__auto__;
}
})(),current_user_id,root_comment_data,cljs.core.partial.cljs$core$IFn$_invoke$arity$3(oc.web.components.stream_comments.delete_clicked,s,activity_data),((showing_picker_QMARK_)?oc.web.components.stream_comments.emoji_picker_container(s,root_comment_data):null),new cljs.core.Keyword("oc.web.components.stream-comments","show-more-menu","oc.web.components.stream-comments/show-more-menu",-866992705).cljs$core$IFn$_invoke$arity$1(s),edit_comment_key]);
return (oc.web.components.stream_comments.read_comment.cljs$core$IFn$_invoke$arity$1 ? oc.web.components.stream_comments.read_comment.cljs$core$IFn$_invoke$arity$1(G__46190) : oc.web.components.stream_comments.read_comment.call(null,G__46190));
})()))),oc$web$components$stream_comments$iter__46177(cljs.core.rest(s__46178__$2)));
}
} else {
return null;
}
break;
}
}),null,null));
});
return iter__4529__auto__(cljs.core.range.cljs$core$IFn$_invoke$arity$1(cljs.core.count(threads)));
})())], null):new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [sablono.interpreter.interpret(attrs46172),cljs.core.into_array.cljs$core$IFn$_invoke$arity$1((function (){var iter__4529__auto__ = (function oc$web$components$stream_comments$iter__46201(s__46202){
return (new cljs.core.LazySeq(null,(function (){
var s__46202__$1 = s__46202;
while(true){
var temp__5735__auto__ = cljs.core.seq(s__46202__$1);
if(temp__5735__auto__){
var s__46202__$2 = temp__5735__auto__;
if(cljs.core.chunked_seq_QMARK_(s__46202__$2)){
var c__4527__auto__ = cljs.core.chunk_first(s__46202__$2);
var size__4528__auto__ = cljs.core.count(c__4527__auto__);
var b__46204 = cljs.core.chunk_buffer(size__4528__auto__);
if((function (){var i__46203 = (0);
while(true){
if((i__46203 < size__4528__auto__)){
var idx = cljs.core._nth(c__4527__auto__,i__46203);
var root_comment_data = cljs.core.nth.cljs$core$IFn$_invoke$arity$2(threads,idx);
var is_editing_QMARK_ = ((cljs.core.seq(cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","editing?","oc.web.components.stream-comments/editing?",443654745).cljs$core$IFn$_invoke$arity$1(s)))) && (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","editing?","oc.web.components.stream-comments/editing?",443654745).cljs$core$IFn$_invoke$arity$1(s)),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data))));
var add_comment_string_key = oc.web.dispatcher.add_comment_string_key.cljs$core$IFn$_invoke$arity$3(new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(activity_data),new cljs.core.Keyword(null,"reply-parent","reply-parent",579138103).cljs$core$IFn$_invoke$arity$1(root_comment_data),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data));
var edit_comment_key = cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(add_comment_force_update_STAR_,add_comment_string_key);
var showing_picker_QMARK_ = ((cljs.core.seq(cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","show-picker","oc.web.components.stream-comments/show-picker",-388195508).cljs$core$IFn$_invoke$arity$1(s)))) && (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","show-picker","oc.web.components.stream-comments/show-picker",-388195508).cljs$core$IFn$_invoke$arity$1(s)),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data))));
cljs.core.chunk_append(b__46204,React.createElement("div",({"key": ["stream-comments-thread-",cljs.core.str.cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data))].join(''), "className": "stream-comment-thread"}),((is_editing_QMARK_)?sablono.interpreter.interpret((function (){var G__46211 = new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"activity-data","activity-data",1293689136),activity_data,new cljs.core.Keyword(null,"comment-data","comment-data",736267705),root_comment_data,new cljs.core.Keyword(null,"dismiss-reply-cb","dismiss-reply-cb",1894601324),cljs.core.partial.cljs$core$IFn$_invoke$arity$3(oc.web.components.stream_comments.finish_edit,s,root_comment_data),new cljs.core.Keyword(null,"edit-comment-key","edit-comment-key",-1517723522),edit_comment_key], null);
return (oc.web.components.stream_comments.edit_comment.cljs$core$IFn$_invoke$arity$1 ? oc.web.components.stream_comments.edit_comment.cljs$core$IFn$_invoke$arity$1(G__46211) : oc.web.components.stream_comments.edit_comment.call(null,G__46211));
})()):sablono.interpreter.interpret((function (){var G__46212 = cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,"editing?","editing?",1646440800),new cljs.core.Keyword(null,"did-react-cb","did-react-cb",1627613154),new cljs.core.Keyword(null,"react-cb","react-cb",-2110368957),new cljs.core.Keyword(null,"is-mobile?","is-mobile?",2146205507),new cljs.core.Keyword(null,"edit-cb","edit-cb",-974954589),new cljs.core.Keyword(null,"member?","member?",486668360),new cljs.core.Keyword(null,"showing-picker?","showing-picker?",-369252247),new cljs.core.Keyword(null,"can-show-delete-bt?","can-show-delete-bt?",-1502851606),new cljs.core.Keyword(null,"reply-cb","reply-cb",-120094452),new cljs.core.Keyword(null,"dismiss-reply-cb","dismiss-reply-cb",1894601324),new cljs.core.Keyword(null,"activity-data","activity-data",1293689136),new cljs.core.Keyword(null,"mouse-leave-cb","mouse-leave-cb",1257434096),new cljs.core.Keyword(null,"can-show-edit-bt?","can-show-edit-bt?",-992517037),new cljs.core.Keyword(null,"current-user-id","current-user-id",-2013633451),new cljs.core.Keyword(null,"comment-data","comment-data",736267705),new cljs.core.Keyword(null,"delete-cb","delete-cb",895299386),new cljs.core.Keyword(null,"emoji-picker","emoji-picker",-447764229),new cljs.core.Keyword(null,"show-more-menu","show-more-menu",-283004228),new cljs.core.Keyword(null,"edit-comment-key","edit-comment-key",-1517723522)],[(!((cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","editing?","oc.web.components.stream-comments/editing?",443654745).cljs$core$IFn$_invoke$arity$1(s)) == null))),((function (i__46203,root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,c__4527__auto__,size__4528__auto__,b__46204,s__46202__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count){
return (function (){
return oc.web.components.stream_comments.comment_mark_read(s,new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data));
});})(i__46203,root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,c__4527__auto__,size__4528__auto__,b__46204,s__46202__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count))
,((function (i__46203,root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,c__4527__auto__,size__4528__auto__,b__46204,s__46202__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count){
return (function (){
return cljs.core.reset_BANG_(new cljs.core.Keyword("oc.web.components.stream-comments","show-picker","oc.web.components.stream-comments/show-picker",-388195508).cljs$core$IFn$_invoke$arity$1(s),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data));
});})(i__46203,root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,c__4527__auto__,size__4528__auto__,b__46204,s__46202__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count))
,is_mobile_QMARK_,cljs.core.partial.cljs$core$IFn$_invoke$arity$2(oc.web.components.stream_comments.start_editing,s),member_QMARK_,showing_picker_QMARK_,new cljs.core.Keyword(null,"can-delete","can-delete",1620748590).cljs$core$IFn$_invoke$arity$1(root_comment_data),((function (i__46203,root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,c__4527__auto__,size__4528__auto__,b__46204,s__46202__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count){
return (function (){
return oc.web.actions.comment.reply_to.cljs$core$IFn$_invoke$arity$variadic(reply_focus_value,new cljs.core.Keyword(null,"body","body",-2049205669).cljs$core$IFn$_invoke$arity$1(root_comment_data),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([true], 0));
});})(i__46203,root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,c__4527__auto__,size__4528__auto__,b__46204,s__46202__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count))
,cljs.core.partial.cljs$core$IFn$_invoke$arity$3(oc.web.components.stream_comments.finish_edit,s,root_comment_data),activity_data,((function (i__46203,root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,c__4527__auto__,size__4528__auto__,b__46204,s__46202__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count){
return (function (){
return cljs.core.compare_and_set_BANG_(new cljs.core.Keyword("oc.web.components.stream-comments","show-more-menu","oc.web.components.stream-comments/show-more-menu",-866992705).cljs$core$IFn$_invoke$arity$1(s),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data),null);
});})(i__46203,root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,c__4527__auto__,size__4528__auto__,b__46204,s__46202__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count))
,(function (){var and__4115__auto__ = new cljs.core.Keyword(null,"can-edit","can-edit",442089902).cljs$core$IFn$_invoke$arity$1(root_comment_data);
if(cljs.core.truth_(and__4115__auto__)){
return cljs.core.not(new cljs.core.Keyword(null,"is-emoji","is-emoji",-1643384064).cljs$core$IFn$_invoke$arity$1(root_comment_data));
} else {
return and__4115__auto__;
}
})(),current_user_id,root_comment_data,cljs.core.partial.cljs$core$IFn$_invoke$arity$3(oc.web.components.stream_comments.delete_clicked,s,activity_data),((showing_picker_QMARK_)?oc.web.components.stream_comments.emoji_picker_container(s,root_comment_data):null),new cljs.core.Keyword("oc.web.components.stream-comments","show-more-menu","oc.web.components.stream-comments/show-more-menu",-866992705).cljs$core$IFn$_invoke$arity$1(s),edit_comment_key]);
return (oc.web.components.stream_comments.read_comment.cljs$core$IFn$_invoke$arity$1 ? oc.web.components.stream_comments.read_comment.cljs$core$IFn$_invoke$arity$1(G__46212) : oc.web.components.stream_comments.read_comment.call(null,G__46212));
})()))));

var G__46277 = (i__46203 + (1));
i__46203 = G__46277;
continue;
} else {
return true;
}
break;
}
})()){
return cljs.core.chunk_cons(cljs.core.chunk(b__46204),oc$web$components$stream_comments$iter__46201(cljs.core.chunk_rest(s__46202__$2)));
} else {
return cljs.core.chunk_cons(cljs.core.chunk(b__46204),null);
}
} else {
var idx = cljs.core.first(s__46202__$2);
var root_comment_data = cljs.core.nth.cljs$core$IFn$_invoke$arity$2(threads,idx);
var is_editing_QMARK_ = ((cljs.core.seq(cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","editing?","oc.web.components.stream-comments/editing?",443654745).cljs$core$IFn$_invoke$arity$1(s)))) && (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","editing?","oc.web.components.stream-comments/editing?",443654745).cljs$core$IFn$_invoke$arity$1(s)),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data))));
var add_comment_string_key = oc.web.dispatcher.add_comment_string_key.cljs$core$IFn$_invoke$arity$3(new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(activity_data),new cljs.core.Keyword(null,"reply-parent","reply-parent",579138103).cljs$core$IFn$_invoke$arity$1(root_comment_data),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data));
var edit_comment_key = cljs.core.get_in.cljs$core$IFn$_invoke$arity$2(add_comment_force_update_STAR_,add_comment_string_key);
var showing_picker_QMARK_ = ((cljs.core.seq(cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","show-picker","oc.web.components.stream-comments/show-picker",-388195508).cljs$core$IFn$_invoke$arity$1(s)))) && (cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","show-picker","oc.web.components.stream-comments/show-picker",-388195508).cljs$core$IFn$_invoke$arity$1(s)),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data))));
return cljs.core.cons(React.createElement("div",({"key": ["stream-comments-thread-",cljs.core.str.cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data))].join(''), "className": "stream-comment-thread"}),((is_editing_QMARK_)?sablono.interpreter.interpret((function (){var G__46220 = new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"activity-data","activity-data",1293689136),activity_data,new cljs.core.Keyword(null,"comment-data","comment-data",736267705),root_comment_data,new cljs.core.Keyword(null,"dismiss-reply-cb","dismiss-reply-cb",1894601324),cljs.core.partial.cljs$core$IFn$_invoke$arity$3(oc.web.components.stream_comments.finish_edit,s,root_comment_data),new cljs.core.Keyword(null,"edit-comment-key","edit-comment-key",-1517723522),edit_comment_key], null);
return (oc.web.components.stream_comments.edit_comment.cljs$core$IFn$_invoke$arity$1 ? oc.web.components.stream_comments.edit_comment.cljs$core$IFn$_invoke$arity$1(G__46220) : oc.web.components.stream_comments.edit_comment.call(null,G__46220));
})()):sablono.interpreter.interpret((function (){var G__46225 = cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,"editing?","editing?",1646440800),new cljs.core.Keyword(null,"did-react-cb","did-react-cb",1627613154),new cljs.core.Keyword(null,"react-cb","react-cb",-2110368957),new cljs.core.Keyword(null,"is-mobile?","is-mobile?",2146205507),new cljs.core.Keyword(null,"edit-cb","edit-cb",-974954589),new cljs.core.Keyword(null,"member?","member?",486668360),new cljs.core.Keyword(null,"showing-picker?","showing-picker?",-369252247),new cljs.core.Keyword(null,"can-show-delete-bt?","can-show-delete-bt?",-1502851606),new cljs.core.Keyword(null,"reply-cb","reply-cb",-120094452),new cljs.core.Keyword(null,"dismiss-reply-cb","dismiss-reply-cb",1894601324),new cljs.core.Keyword(null,"activity-data","activity-data",1293689136),new cljs.core.Keyword(null,"mouse-leave-cb","mouse-leave-cb",1257434096),new cljs.core.Keyword(null,"can-show-edit-bt?","can-show-edit-bt?",-992517037),new cljs.core.Keyword(null,"current-user-id","current-user-id",-2013633451),new cljs.core.Keyword(null,"comment-data","comment-data",736267705),new cljs.core.Keyword(null,"delete-cb","delete-cb",895299386),new cljs.core.Keyword(null,"emoji-picker","emoji-picker",-447764229),new cljs.core.Keyword(null,"show-more-menu","show-more-menu",-283004228),new cljs.core.Keyword(null,"edit-comment-key","edit-comment-key",-1517723522)],[(!((cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","editing?","oc.web.components.stream-comments/editing?",443654745).cljs$core$IFn$_invoke$arity$1(s)) == null))),((function (root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,s__46202__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count){
return (function (){
return oc.web.components.stream_comments.comment_mark_read(s,new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data));
});})(root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,s__46202__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count))
,((function (root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,s__46202__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count){
return (function (){
return cljs.core.reset_BANG_(new cljs.core.Keyword("oc.web.components.stream-comments","show-picker","oc.web.components.stream-comments/show-picker",-388195508).cljs$core$IFn$_invoke$arity$1(s),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data));
});})(root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,s__46202__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count))
,is_mobile_QMARK_,cljs.core.partial.cljs$core$IFn$_invoke$arity$2(oc.web.components.stream_comments.start_editing,s),member_QMARK_,showing_picker_QMARK_,new cljs.core.Keyword(null,"can-delete","can-delete",1620748590).cljs$core$IFn$_invoke$arity$1(root_comment_data),((function (root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,s__46202__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count){
return (function (){
return oc.web.actions.comment.reply_to.cljs$core$IFn$_invoke$arity$variadic(reply_focus_value,new cljs.core.Keyword(null,"body","body",-2049205669).cljs$core$IFn$_invoke$arity$1(root_comment_data),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([true], 0));
});})(root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,s__46202__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count))
,cljs.core.partial.cljs$core$IFn$_invoke$arity$3(oc.web.components.stream_comments.finish_edit,s,root_comment_data),activity_data,((function (root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,s__46202__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count){
return (function (){
return cljs.core.compare_and_set_BANG_(new cljs.core.Keyword("oc.web.components.stream-comments","show-more-menu","oc.web.components.stream-comments/show-more-menu",-866992705).cljs$core$IFn$_invoke$arity$1(s),new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(root_comment_data),null);
});})(root_comment_data,is_editing_QMARK_,add_comment_string_key,edit_comment_key,showing_picker_QMARK_,idx,s__46202__$2,temp__5735__auto__,attrs46172,_users_info_hover,_current_user_data,_follow_publishers_list,_followers_publishers_count,add_comment_force_update_STAR_,is_mobile_QMARK_,threads,all_comments,reply_focus_value,map__46163,map__46163__$1,activity_data,comments_data,last_read_at,current_user_id,member_QMARK_,reply_add_comment_prefix,loading_comments_count))
,(function (){var and__4115__auto__ = new cljs.core.Keyword(null,"can-edit","can-edit",442089902).cljs$core$IFn$_invoke$arity$1(root_comment_data);
if(cljs.core.truth_(and__4115__auto__)){
return cljs.core.not(new cljs.core.Keyword(null,"is-emoji","is-emoji",-1643384064).cljs$core$IFn$_invoke$arity$1(root_comment_data));
} else {
return and__4115__auto__;
}
})(),current_user_id,root_comment_data,cljs.core.partial.cljs$core$IFn$_invoke$arity$3(oc.web.components.stream_comments.delete_clicked,s,activity_data),((showing_picker_QMARK_)?oc.web.components.stream_comments.emoji_picker_container(s,root_comment_data):null),new cljs.core.Keyword("oc.web.components.stream-comments","show-more-menu","oc.web.components.stream-comments/show-more-menu",-866992705).cljs$core$IFn$_invoke$arity$1(s),edit_comment_key]);
return (oc.web.components.stream_comments.read_comment.cljs$core$IFn$_invoke$arity$1 ? oc.web.components.stream_comments.read_comment.cljs$core$IFn$_invoke$arity$1(G__46225) : oc.web.components.stream_comments.read_comment.call(null,G__46225));
})()))),oc$web$components$stream_comments$iter__46201(cljs.core.rest(s__46202__$2)));
}
} else {
return null;
}
break;
}
}),null,null));
});
return iter__4529__auto__(cljs.core.range.cljs$core$IFn$_invoke$arity$1(cljs.core.count(threads)));
})())], null)));
})():null));
}),new cljs.core.PersistentVector(null, 20, 5, cljs.core.PersistentVector.EMPTY_NODE, [rum.core.reactive,org.martinklepsch.derivatives.drv.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,"add-comment-focus","add-comment-focus",-452934461)], 0)),org.martinklepsch.derivatives.drv.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,"add-comment-data","add-comment-data",-1679568046)], 0)),org.martinklepsch.derivatives.drv.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,"users-info-hover","users-info-hover",-941434570)], 0)),org.martinklepsch.derivatives.drv.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,"current-user-data","current-user-data",-1647873915)], 0)),org.martinklepsch.derivatives.drv.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,"follow-publishers-list","follow-publishers-list",-374150342)], 0)),org.martinklepsch.derivatives.drv.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,"followers-publishers-count","followers-publishers-count",-692976579)], 0)),rum.core.local.cljs$core$IFn$_invoke$arity$2(false,new cljs.core.Keyword("oc.web.components.stream-comments","last-focused-state","oc.web.components.stream-comments/last-focused-state",-571230555)),rum.core.local.cljs$core$IFn$_invoke$arity$2(null,new cljs.core.Keyword("oc.web.components.stream-comments","editing?","oc.web.components.stream-comments/editing?",443654745)),rum.core.local.cljs$core$IFn$_invoke$arity$2(null,new cljs.core.Keyword("oc.web.components.stream-comments","show-picker","oc.web.components.stream-comments/show-picker",-388195508)),rum.core.local.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentArrayMap.EMPTY,new cljs.core.Keyword("oc.web.components.stream-comments","comment-url-copy","oc.web.components.stream-comments/comment-url-copy",1827245738)),rum.core.local.cljs$core$IFn$_invoke$arity$2(false,new cljs.core.Keyword("oc.web.components.stream-comments","initial-comment-scroll","oc.web.components.stream-comments/initial-comment-scroll",992189380)),rum.core.local.cljs$core$IFn$_invoke$arity$2(null,new cljs.core.Keyword("oc.web.components.stream-comments","show-more-menu","oc.web.components.stream-comments/show-more-menu",-866992705)),rum.core.local.cljs$core$IFn$_invoke$arity$2(cljs.core.PersistentVector.EMPTY,new cljs.core.Keyword("oc.web.components.stream-comments","threads","oc.web.components.stream-comments/threads",468518835)),org.martinklepsch.derivatives.drv.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.Keyword(null,"add-comment-force-update","add-comment-force-update",1376707794)], 0)),oc.web.mixins.mention.oc_mentions_hover.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"click?","click?",-1210364665),true], null)], 0)),oc.web.mixins.ui.refresh_tooltips_mixin,oc.web.mixins.ui.interactive_images_mixin("div.stream-comment-body"),oc.web.mixins.ui.on_window_click_mixin((function (s,e){
if(cljs.core.truth_((function (){var and__4115__auto__ = cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","show-picker","oc.web.components.stream-comments/show-picker",-388195508).cljs$core$IFn$_invoke$arity$1(s));
if(cljs.core.truth_(and__4115__auto__)){
return cljs.core.not(oc.web.lib.utils.event_inside_QMARK_(e,$("div.emoji-mart",rum.core.dom_node(s)).get((0))));
} else {
return and__4115__auto__;
}
})())){
return cljs.core.reset_BANG_(new cljs.core.Keyword("oc.web.components.stream-comments","show-picker","oc.web.components.stream-comments/show-picker",-388195508).cljs$core$IFn$_invoke$arity$1(s),null);
} else {
return null;
}
})),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"after-render","after-render",1997533433),(function (s){
var activity_uuid_46278 = new cljs.core.Keyword(null,"uuid","uuid",-2145095719).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"activity-data","activity-data",1293689136).cljs$core$IFn$_invoke$arity$1(cljs.core.first(new cljs.core.Keyword("rum","args","rum/args",1315791754).cljs$core$IFn$_invoke$arity$1(s))));
var focused_uuid_46279 = cljs.core.deref(org.martinklepsch.derivatives.get_ref(s,new cljs.core.Keyword(null,"add-comment-focus","add-comment-focus",-452934461)));
var current_local_state_46280 = cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","last-focused-state","oc.web.components.stream-comments/last-focused-state",-571230555).cljs$core$IFn$_invoke$arity$1(s));
var is_self_focused_QMARK__46281 = cljs.core._EQ_.cljs$core$IFn$_invoke$arity$2(focused_uuid_46279,activity_uuid_46278);
if(cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(current_local_state_46280,is_self_focused_QMARK__46281)){
cljs.core.reset_BANG_(new cljs.core.Keyword("oc.web.components.stream-comments","last-focused-state","oc.web.components.stream-comments/last-focused-state",-571230555).cljs$core$IFn$_invoke$arity$1(s),is_self_focused_QMARK__46281);

if(is_self_focused_QMARK__46281){
oc.web.components.stream_comments.scroll_to_bottom(s);
} else {
}
} else {
}

return s;
}),new cljs.core.Keyword(null,"will-mount","will-mount",-434633071),(function (s){
var map__46230_46282 = cljs.core.first(new cljs.core.Keyword("rum","args","rum/args",1315791754).cljs$core$IFn$_invoke$arity$1(s));
var map__46230_46283__$1 = (((((!((map__46230_46282 == null))))?(((((map__46230_46282.cljs$lang$protocol_mask$partition0$ & (64))) || ((cljs.core.PROTOCOL_SENTINEL === map__46230_46282.cljs$core$ISeq$))))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__46230_46282):map__46230_46282);
var last_read_at_46284 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46230_46283__$1,new cljs.core.Keyword(null,"last-read-at","last-read-at",-216601930));
var comments_data_46285 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46230_46283__$1,new cljs.core.Keyword(null,"comments-data","comments-data",1871210833));
var threads_46286 = oc.web.utils.comment.collapse_comments.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([comments_data_46285,last_read_at_46284], 0));
var fixed_threads_46287 = cljs.core.filterv((function (p1__46154_SHARP_){
return cljs.core.not(oc.web.utils.activity.resource_type_QMARK_.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([p1__46154_SHARP_,new cljs.core.Keyword(null,"collapsed-comments","collapsed-comments",-492771788)], 0)));
}),threads_46286);
cljs.core.reset_BANG_(new cljs.core.Keyword("oc.web.components.stream-comments","threads","oc.web.components.stream-comments/threads",468518835).cljs$core$IFn$_invoke$arity$1(s),fixed_threads_46287);

return s;
}),new cljs.core.Keyword(null,"did-mount","did-mount",918232960),(function (s){
try{emojiAutocomplete();
}catch (e46232){var e_46288 = e46232;
}
return s;
}),new cljs.core.Keyword(null,"did-remount","did-remount",1362550500),(function (o,s){
var map__46237_46289 = cljs.core.first(new cljs.core.Keyword("rum","args","rum/args",1315791754).cljs$core$IFn$_invoke$arity$1(s));
var map__46237_46290__$1 = (((((!((map__46237_46289 == null))))?(((((map__46237_46289.cljs$lang$protocol_mask$partition0$ & (64))) || ((cljs.core.PROTOCOL_SENTINEL === map__46237_46289.cljs$core$ISeq$))))?true:false):false))?cljs.core.apply.cljs$core$IFn$_invoke$arity$2(cljs.core.hash_map,map__46237_46289):map__46237_46289);
var comments_data_46291 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46237_46290__$1,new cljs.core.Keyword(null,"comments-data","comments-data",1871210833));
var last_read_at_46292 = cljs.core.get.cljs$core$IFn$_invoke$arity$2(map__46237_46290__$1,new cljs.core.Keyword(null,"last-read-at","last-read-at",-216601930));
var comments_diff_46293 = clojure.data.diff(new cljs.core.Keyword(null,"comments-data","comments-data",1871210833).cljs$core$IFn$_invoke$arity$1(cljs.core.first(new cljs.core.Keyword("rum","args","rum/args",1315791754).cljs$core$IFn$_invoke$arity$1(o))),comments_data_46291);
if(((cljs.core.seq(cljs.core.first(comments_diff_46293))) || (cljs.core.seq(cljs.core.second(comments_diff_46293))) || (cljs.core.not_EQ_.cljs$core$IFn$_invoke$arity$2(last_read_at_46292,new cljs.core.Keyword(null,"last-read-at","last-read-at",-216601930).cljs$core$IFn$_invoke$arity$1(cljs.core.first(new cljs.core.Keyword("rum","args","rum/args",1315791754).cljs$core$IFn$_invoke$arity$1(o))))))){
var all_comments_46294 = cljs.core.vec(cljs.core.mapcat.cljs$core$IFn$_invoke$arity$variadic((function (p1__46155_SHARP_){
return cljs.core.concat.cljs$core$IFn$_invoke$arity$2(new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [p1__46155_SHARP_], null),new cljs.core.Keyword(null,"thread-children","thread-children",78675219).cljs$core$IFn$_invoke$arity$1(p1__46155_SHARP_));
}),cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([cljs.core.deref(new cljs.core.Keyword("oc.web.components.stream-comments","threads","oc.web.components.stream-comments/threads",468518835).cljs$core$IFn$_invoke$arity$1(s))], 0)));
var collapsed_map_46295 = cljs.core.zipmap(cljs.core.map.cljs$core$IFn$_invoke$arity$2(new cljs.core.Keyword(null,"uuid","uuid",-2145095719),all_comments_46294),cljs.core.map.cljs$core$IFn$_invoke$arity$2((function (p1__46156_SHARP_){
return cljs.core.select_keys(p1__46156_SHARP_,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"expanded","expanded",-3020742),new cljs.core.Keyword(null,"unread","unread",-1950424572)], null));
}),all_comments_46294));
var updated_threads_46296 = oc.web.utils.comment.collapse_comments.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([comments_data_46291,last_read_at_46292], 0));
var fixed_updated_threads_46297 = cljs.core.filterv((function (p1__46157_SHARP_){
return cljs.core.not(oc.web.utils.activity.resource_type_QMARK_.cljs$core$IFn$_invoke$arity$variadic(cljs.core.prim_seq.cljs$core$IFn$_invoke$arity$2([p1__46157_SHARP_,new cljs.core.Keyword(null,"collapsed-comments","collapsed-comments",-492771788)], 0)));
}),updated_threads_46296);
cljs.core.reset_BANG_(new cljs.core.Keyword("oc.web.components.stream-comments","threads","oc.web.components.stream-comments/threads",468518835).cljs$core$IFn$_invoke$arity$1(s),fixed_updated_threads_46297);
} else {
}

try{emojiAutocomplete();
}catch (e46242){var e_46298 = e46242;
}
return s;
})], null)], null),"stream-comments");

//# sourceMappingURL=oc.web.components.stream_comments.js.map
