{"version":3,"sources":["oc/web/stores/jwt.cljs"],"mappings":";AASA,AAAAA,AAAA,AAAA,AAAAC,AACGG;AADH,AAAA,AAAAF,AAAAD;AAAA,AAAAE,AAAAD,AAAA,AAAA,AACOG;AADP,AAEE,AAAMC,AAAS,AAACC;AACVC,AAAQ,AAAI,AAAA,AAACC,AACH,AAACC,AAAMN,AAAGO,AAAkC,AAACC,AAAQ,AAAA,AAACH,AACtDL;AAHhB,AAIE,AAAAS,AAAAC,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAC,AAAA;AAAA,AAAA,AAAcT;AAAd,AAAA,AAAA;;AACA,AAAA,AAACI,AAAMF,AAAaF;;AAGxB,AAAAN,AAAA,AAAA,AAAAgB,AACGZ;AADH,AAAA,AAAAa,AAAAD;AAAA,AAAAb,AAAAc,AAAA,AAAA,AACOZ;AADP,AAEE,AAAMC,AAAS,AAACY;AACVV,AAAQ,AAAI,AAAA,AAACC,AACH,AAACC,AAAMN,AAAGO,AAAkC,AAACC,AAAQ,AAAA,AAACH,AACtDL;AAHhB,AAIE,AAAAS,AAAAC,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAC,AAAA;AAAA,AAAA,AAAcT;AAAd,AAAA,AAAA;;AACA,AAAA,AAACI,AAAMF,AAAkBF","names":["oc.web.dispatcher/action","p__43280","vec__43281","cljs.core.nth","db","_","jwt-data","oc.web.lib.jwt/get-contents","next-db","oc.web.lib.cookies/get-cookie","cljs.core.assoc","oc.web.dispatcher/show-login-overlay-key","cljs.core.keyword","taoensso.timbre._log_BANG_","taoensso.timbre/*config*","cljs.core/Delay","p__43286","vec__43287","oc.web.lib.jwt.get_id_token_contents"],"sourcesContent":["(ns oc.web.stores.jwt\n  (:require [taoensso.timbre :as timbre]\n            [oc.web.lib.jwt :as j]\n            [oc.web.lib.cookies :as cook]\n            [oc.web.dispatcher :as dispatcher]))\n\n;; JWT handling\n\n;; Store JWT in App DB so it can be easily accessed in actions etc.\n(defmethod dispatcher/action :jwt\n  [db [_]]\n  (let [jwt-data (j/get-contents)\n        next-db (if (cook/get-cookie :show-login-overlay)\n                  (assoc db dispatcher/show-login-overlay-key (keyword (cook/get-cookie :show-login-overlay)))\n                  db)]\n    (timbre/debug jwt-data)\n    (assoc next-db :jwt jwt-data)))\n\n\n(defmethod dispatcher/action :id-token\n  [db [_]]\n  (let [jwt-data (j/get-id-token-contents)\n        next-db (if (cook/get-cookie :show-login-overlay)\n                  (assoc db dispatcher/show-login-overlay-key (keyword (cook/get-cookie :show-login-overlay)))\n                  db)]\n    (timbre/debug jwt-data)\n    (assoc next-db :id-token jwt-data)))"]}