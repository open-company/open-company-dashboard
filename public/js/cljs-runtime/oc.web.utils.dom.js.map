{"version":3,"sources":["oc/web/utils/dom.cljs"],"mappings":"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","names":["js/oc","js/oc.web","js/oc.web.utils","js/oc.web.utils.dom","js/oc.web.utils.dom.onload-recalc-measure-class","oc.web.utils.dom/onload-recalc-measure-class","js/oc.web.utils.dom._lock-counter","oc.web.utils.dom/_lock-counter","cljs.core.atom","oc.web.utils.dom/lock-page-scroll","cljs.core.swap_BANG_","cljs.core/inc","dommy.core.add_class_BANG_","js/document","oc.web.utils.dom/unlock-page-scroll","cljs.core/dec","cljs.core/deref","cljs.core/reset!","dommy.core.remove_class_BANG_","var_args","args__4742__auto__","len__4736__auto__","i__4737__auto__","argseq__4743__auto__","cljs.core/IndexedSeq","oc.web.utils.dom/is-element-bottom-in-viewport?","p__48952","vec__48953","cljs.core.nth","seq48950","G__48951","cljs.core/first","cljs.core/next","self__4723__auto__","el","offset","p1__48949#","fixed-offset","or__4126__auto__","rect","zero-pos?","doc-element","win-height","js/window","oc.web.lib.responsive/navbar-height","oc.web.utils.dom/is-element-top-in-viewport?","p__48976","vec__48977","seq48971","G__48972","p1__48965#","oc.web.utils.dom/viewport-width","oc.web.utils.dom/viewport-height","oc.web.utils.dom/viewport-size","oc.web.utils.dom/viewport-offset","element","oc.web.utils.dom/event-inside?","e","cljs.core._EQ_","oc.web.utils.dom/event-cotainer-has-class","class-name"],"sourcesContent":["(ns oc.web.utils.dom\n  (:require [dommy.core :as dommy :refer-macros (sel1)]\n            [oc.web.lib.responsive :as responsive]))\n\n(defonce onload-recalc-measure-class \"onload-reaclc-measure\")\n\n(defonce _lock-counter (atom 0))\n\n(defn lock-page-scroll\n  \"Add no-scroll class to the page body tag to lock the scroll\"\n  []\n  (swap! _lock-counter inc)\n  (dommy/add-class! (sel1 [:html]) :no-scroll))\n\n(defn unlock-page-scroll\n  \"Remove no-scroll class from the page body tag to unlock the scroll\"\n  []\n  (swap! _lock-counter dec)\n  (when-not (pos? @_lock-counter)\n    (reset! _lock-counter 0)\n    (dommy/remove-class! (sel1 [:html]) :no-scroll)))\n\n(defn is-element-bottom-in-viewport?\n   \"Given a DOM element return true if the bottom of it is actually visible in the viewport/\"\n  [el & [offset]]\n  (let [fixed-offset (or offset 0)\n        rect (.getBoundingClientRect el)\n        zero-pos? #(or (zero? %)\n                       (pos? %))\n        doc-element (.-documentElement js/document)\n        win-height (or (.-clientHeight doc-element)\n                       (.-innerHeight js/window))]\n           ;; Item bottom is more then the navbar height\n      (and (>= (+ (.-top rect) (.-height rect) fixed-offset) responsive/navbar-height)\n           ;; and less than the screen height\n           (< (+ (.-top rect) (.-height rect)) win-height))))\n\n(defn is-element-top-in-viewport?\n   \"Given a DOM element return true if it's actually visible in the viewport.\"\n  [el & [offset]]\n  (let [fixed-offset (or offset 0)\n        rect (.getBoundingClientRect el)\n        zero-pos? #(or (zero? %)\n                       (pos? %))\n        doc-element (.-documentElement js/document)\n        win-height (or (.-clientHeight doc-element)\n                       (.-innerHeight js/window))]\n           ;; Item top is more then the navbar height\n      (and (>= (+ (.-top rect) fixed-offset) responsive/navbar-height)\n           ;; and less than the screen height\n           (< (.-top rect) win-height))))\n\n(defn viewport-width []\n  (or (.-clientWidth (.-documentElement js/document))\n      (.-innerWidth js/window)))\n\n(defn viewport-height []\n  (or (.-clientHeight (.-documentElement js/document))\n      (.-innerHeight js/window)))\n\n(defn viewport-size []\n  {:width (viewport-width)\n   :height (viewport-height)})\n\n(defn viewport-offset [element]\n  (when element\n    (let [rect (.getBoundingClientRect element)]\n      {:x (.-left rect)\n       :y (.-top rect)})))\n\n(defn event-inside? [e el]\n  (loop [element (.-target e)]\n    (if element\n      (if (= element el)\n        true\n        (recur (.-parentElement element)))\n      false)))\n\n(defn event-cotainer-has-class [e class-name]\n  (when e\n    (loop [element (.-target e)]\n      (if element\n        (if (.contains (.-classList element) class-name)\n          true\n          (recur (.-parentElement element)))\n        false))))"]}